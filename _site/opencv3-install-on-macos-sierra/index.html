<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"> <title>OpenCV 3.x install on macOS Sierra &#8211; Hand Map</title> <meta name="description" content="I have fought the good fight and feel the need to share the process I followed to fix my issues"> <meta name="keywords" content="opencv, sierra, java, python"> <!-- Twitter Cards --> <meta name="twitter:card" content="summary"> <meta name="twitter:image" content="halve.png"> <meta name="twitter:title" content="OpenCV 3.x install on macOS Sierra"> <meta name="twitter:description" content="I have fought the good fight and feel the need to share the process I followed to fix my issues"> <meta name="twitter:site" content="@nathangloverAUS"> <meta name="twitter:creator" content="@nathangloverAUS"> <!-- Open Graph --> <meta property="og:locale" content="en_US"> <meta property="og:type" content="article"> <meta property="og:title" content="OpenCV 3.x install on macOS Sierra"> <meta property="og:description" content="I have fought the good fight and feel the need to share the process I followed to fix my issues"> <meta property="og:url" content="https://handmap.github.io/opencv3-install-on-macos-sierra/"> <meta property="og:site_name" content="Hand Map"> <meta property="og:image" content="https://handmap.github.io/images/halve.png"> <link rel="canonical" href="https://handmap.github.io/opencv3-install-on-macos-sierra/"> <!-- Handheld --> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- Feed --> <link type="application/atom+xml" rel="alternate" href="https://handmap.github.io/feed.xml" title="Hand Map" /> <!-- Favicons --> <link rel="shortcut icon" type="image/png" href="https://handmap.github.io/favicon.png" /> <link rel="shortcut icon" href="https://handmap.github.io/favicon.ico" /> <!-- CSS --> <link rel="stylesheet" type="text/css" href="https://handmap.github.io/assets/css/main.css"> <!-- Left Block Image for Posts --> <style type="text/css"> #posts.inner-post-page .block-left {background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url(https://handmap.github.io/images/unsplash-gallery-image-3.jpg) no-repeat;background-size: cover;} </style> <!-- Left Block Images for Home and Pages --> <style type="text/css"> #posts .block-left {background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url(https://handmap.github.io/images/unsplash-image-10.jpg) no-repeat;background-size: cover, cover;} .block-left {background: linear-gradient(rgba(44,45,51,0.9), rgba(44,45,51,0.9)), url(https://handmap.github.io/images/home.png) no-repeat;background-size: cover;} </style> </head> <body id="posts" class="inner-post-page"> <div class="block-left"> <div class="content"> <a href="https://handmap.github.io" class="logo"><img src="https://handmap.github.io/images/halve.png"></a> <div class="post-title-section"> <div class="section-line">Posts <em>/</em></div> <h1 class="section-title">OpenCV 3.x install on macOS Sierra </h1> <ul class="tags"> <li><a href="https://handmap.github.io/tags#opencv">opencv</a></li> <li><a href="https://handmap.github.io/tags#sierra">sierra</a></li> <li><a href="https://handmap.github.io/tags#java">java</a></li> <li><a href="https://handmap.github.io/tags#python">python</a></li> </ul> <div class="section-line reverse"><a href="https://handmap.github.io/posts">Back to posts</a> <em>/</em></div> </div> </div> </div> <div class="block-right"> <div class="share-buttons"> <a href="https://twitter.com/intent/tweet?text=https://handmap.github.io/opencv3-install-on-macos-sierra/" class="btn btn_twitter" title="Share on Twitter"><i class="fa fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a> <a href="https://www.facebook.com/sharer/sharer.php?u=https://handmap.github.io/opencv3-install-on-macos-sierra/" class="btn btn_facebook" title="Share on Facebook"><i class="fa fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a> <a href="https://plus.google.com/share?url=https://handmap.github.io/opencv3-install-on-macos-sierra/" class="btn btn_google-plus" title="Share on Google Plus"><i class="fa fa-fw fa-google-plus" aria-hidden="true"></i><span> Google+</span></a> </div> <a href="../posts.html" title="posts" class="posts-menu-icon"></a> <a title="projects" class="projects-menu-icon"> <span></span> </a> <div class="inner-post content"> <div class="date-highlight">27 Sep 2016</div> <h2 id="problem">Problem</h2> <hr /> <p>So for the past month and a half I have battled furiously with getting OpenCV 3.x installed on my Macbook Pro that I accidentally upgraded to Sierra on.</p> <div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="c">#import &lt;QTKit/QTKit.h&gt;</span>
        ^
1 error generated.
make[2]: <span class="k">***</span> <span class="o">[</span>modules/videoio/CMakeFiles/opencv_videoio.dir/src/cap_qtkit.mm.o] Error 1
make[2]: <span class="k">***</span> Waiting <span class="k">for </span>unfinished jobs....
make[1]: <span class="k">***</span> <span class="o">[</span>modules/videoio/CMakeFiles/opencv_videoio.dir/all] Error 2
make: <span class="k">***</span> <span class="o">[</span>all] Error 2
</code></pre></div> <p>I’m not alone with troubles as it seems that some of the core video/image access and manipulation libraries are no longer bundled with Xcode 8.0 command line tools. To add insult to injury even if you install version &gt;7.0 command line tools you’ll still have issues on Sierra.</p> <h2 id="solution">Solution</h2> <hr /> <p>So the solution has already been implemented for the OpenCV upstream HEAD branch however the changes haven’t quite been merged with the standard repo that brew/science uses to install and build OpenCV. This can be fixed by installing OpenCV with the following arguments</p> <div class="language-bash highlighter-rouge"><pre class="highlight"><code>brew tap homebrew/science
brew install opencv3 --HEAD --with-contrib --with-python3 --with-java
</code></pre></div> <p>You can omit the <code class="highlighter-rouge">--with-python3</code> and <code class="highlighter-rouge">--with-java</code> off the end if you don’t want it installed for Python3.x or java, however there’s no harm having it built. You might just want to make sure you’ve got your Python path registered with Homebrew.</p> <p>Below is a list of other arguements that are available if you see fit:</p> <div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">==&gt; </span>Options
--32-bit
	Build 32-bit only
--c++11
	Build using C++11 mode
--with-contrib
	Build <span class="s2">"extra"</span> contributed modules
--with-cuda
	Build with CUDA v7.0+ support
--with-examples
	Install C and python examples <span class="o">(</span>sources<span class="o">)</span>
--with-ffmpeg
	Build with ffmpeg support
--with-gphoto2
	Build with gphoto2 support
--with-gstreamer
	Build with gstreamer support
--with-jasper
	Build with jasper support
--with-java
	Build with Java support
--with-libdc1394
	Build with libdc1394 support
--with-opengl
	Build with OpenGL support <span class="o">(</span>must use --with-qt5<span class="o">)</span>
--with-openni
	Build with openni support
--with-openni2
	Build with openni2 support
--with-python3
	Build with python3 support
--with-qt
	Build the Qt4 backend to HighGUI
--with-qt5
	Build the Qt5 backend to HighGUI
--with-quicktime
	Use QuickTime <span class="k">for </span>Video I/O instead of QTKit
--with-static
	Build static libraries
--with-tbb
	Enable parallel code <span class="k">in </span>OpenCV using Intel TBB
--with-vtk
	Build with vtk support
--without-eigen
	Build without eigen support
--without-numpy
	Use a numpy you<span class="s1">'ve installed yourself instead of a Homebrew-packaged numpy
--without-opencl
	Disable GPU code in OpenCV using OpenCL
--without-openexr
	Build without openexr support
--without-python
	Build without Python support
--without-test
	Build without accuracy &amp; performance tests
--HEAD
	Install HEAD version
</span></code></pre></div> <p>I would highly recommend installing and symlinking Python2.x and Python3.x with brew instead, as it’ll keep things neat and tidy.</p> <p>Once you’ve successfully installed OpenCV 3.x you’ll needed to symlink a couple paths for your Python2.x and Python3.x libraries. This is done with the following commands</p> <div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="c">## Python 2.7</span>
<span class="nb">echo</span> /usr/local/opt/opencv3/lib/python2.7/site-packages &gt;&gt; /usr/local/lib/python2.7/site-packages/opencv3.pth

<span class="c">## Python 3.5</span>
<span class="nb">echo</span> /usr/local/opt/opencv3/lib/python3.5/site-packages &gt;&gt; /usr/local/lib/python3.5/site-packages/opencv3.pth
</code></pre></div> <p>Your version of the command above might vary depending on where you local python libraries are installed. Amend as necessary.</p> <p>And presto! you should be able to import and check the version of OpenCV from the python command line interpreter</p> <div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="c"># nathan at nathan-macbook in ~ [23:51:55]</span>
→ python

Python 2.7.12 <span class="o">(</span>default, Jul 31 2016, 15:05:20<span class="o">)</span>
<span class="o">[</span>GCC 4.2.1 Compatible Apple LLVM 8.0.0 <span class="o">(</span>clang-800.0.33.1<span class="o">)]</span> on darwin
Type <span class="s2">"help"</span>, <span class="s2">"copyright"</span>, <span class="s2">"credits"</span> or <span class="s2">"license"</span> <span class="k">for </span>more information.

<span class="gp">&gt;&gt;&gt; </span>import cv2
<span class="gp">&gt;&gt;&gt; </span>cv2.__version__
<span class="s1">'3.1.0-dev'</span>
</code></pre></div> <p>Java is fairly similar and the libraries you’ll be working with can be found at the following location:</p> <div class="language-bash highlighter-rouge"><pre class="highlight"><code>/usr/local/opt/opencv3/share/OpenCV/java/opencv-310.jar
</code></pre></div> <p>You can include this library and utilize it in a similar fashion to python.</p> <div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">org.opencv.core.Core</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Main</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">Core</span><span class="o">.</span><span class="na">VERSION</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div> <h2 id="conclusion">Conclusion</h2> <hr /> <p>I am so unbelievably happy I managed to get this working after a painful month or so working out of a virtual machine…</p> <br> <a href="https://twitter.com/intent/tweet?text=https://handmap.github.io/opencv3-install-on-macos-sierra/" class="btn btn_twitter" title="Share on Twitter"><i class="fa fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a> <a href="https://www.facebook.com/sharer/sharer.php?u=https://handmap.github.io/opencv3-install-on-macos-sierra/" class="btn btn_facebook" title="Share on Facebook"><i class="fa fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a> <a href="https://plus.google.com/share?url=https://handmap.github.io/opencv3-install-on-macos-sierra/" class="btn btn_google-plus" title="Share on Google Plus"><i class="fa fa-fw fa-google-plus" aria-hidden="true"></i><span> Google+</span></a> <nav class="pagination"> <a href="https://handmap.github.io/angle-mapping-problem-description/" class="pagination_pager" title="Angle mapping problem description ">previous</a> <a href="https://handmap.github.io/convex-hull-and-contours/" class="pagination_pager" title="Convex hull and contours ">next</a> </nav> </div> </div> <!-- JS --> <script src="https://handmap.github.io/assets/js/main.min.js"></script> <!-- Asynchronous Google Analytics snippet --> <script> (function (i, s, o, g, r, a, m) { i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () { (i[r].q = i[r].q || []).push(arguments) }, i[r].l = 1 * new Date(); a = s.createElement(o), m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m) })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga'); ga('create', 'UA-71336829-11', 'auto'); ga('require', 'linkid', 'linkid.js'); ga('send', 'pageview'); </script> <script type="text/javascript" src="//downloads.mailchimp.com/js/signup-forms/popup/embed.js" data-dojo-config="usePlainJson: true, isDebug: false"></script> <script type="text/javascript">require(["mojo/signup-forms/Loader"], function (L) { L.start({"baseUrl": "mc.us12.list-manage.com", "uuid": "02462dd1a88240d46fd5659d4", "lid": "317288b990"}) })</script> <div class="overlay"> <ul class="projects-menu"> <li style="background:url(https://github.com/HandMap/HandMap.github.io/blob/master/images/project.jpg) center center no-repeat;"> <a href="https://handmap.github.io" class="inactive" target="_blank" rel="nofollow external"> <span> Hand Map Project <br><em>in progress</em> </span> </a> </li> </ul> </div> </body> </html>
