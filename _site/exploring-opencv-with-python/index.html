<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"> <title>Exploring OpenCV with Python &#8211; Hand Map</title> <meta name="description" content="I delve deeper into OpenCV using the Python language and explore how it works at a lower level"> <meta name="keywords" content="python, opencv"> <!-- Twitter Cards --> <meta name="twitter:card" content="summary"> <meta name="twitter:image" content="halve.png"> <meta name="twitter:title" content="Exploring OpenCV with Python"> <meta name="twitter:description" content="I delve deeper into OpenCV using the Python language and explore how it works at a lower level"> <meta name="twitter:site" content="@nathangloverAUS"> <meta name="twitter:creator" content="@nathangloverAUS"> <!-- Open Graph --> <meta property="og:locale" content="en_US"> <meta property="og:type" content="article"> <meta property="og:title" content="Exploring OpenCV with Python"> <meta property="og:description" content="I delve deeper into OpenCV using the Python language and explore how it works at a lower level"> <meta property="og:url" content="https://handmap.github.io/exploring-opencv-with-python/"> <meta property="og:site_name" content="Hand Map"> <meta property="og:image" content="https://handmap.github.io/images/halve.png"> <link rel="canonical" href="https://handmap.github.io/exploring-opencv-with-python/"> <!-- Handheld --> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- Feed --> <link type="application/atom+xml" rel="alternate" href="https://handmap.github.io/feed.xml" title="Hand Map" /> <!-- Favicons --> <link rel="shortcut icon" type="image/png" href="https://handmap.github.io/favicon.png" /> <link rel="shortcut icon" href="https://handmap.github.io/favicon.ico" /> <!-- CSS --> <link rel="stylesheet" type="text/css" href="https://handmap.github.io/assets/css/main.css"> <!-- Left Block Image for Posts --> <style type="text/css"> #posts.inner-post-page .block-left {background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url(https://handmap.github.io/images/unsplash-gallery-image-3.jpg) no-repeat;background-size: cover;} </style> <!-- Left Block Images for Home and Pages --> <style type="text/css"> #posts .block-left {background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url(https://handmap.github.io/images/unsplash-image-10.jpg) no-repeat;background-size: cover, cover;} .block-left {background: linear-gradient(rgba(44,45,51,0.9), rgba(44,45,51,0.9)), url(https://handmap.github.io/images/home.png) no-repeat;background-size: cover;} </style> </head> <body id="posts" class="inner-post-page"> <div class="block-left"> <div class="content"> <a href="https://handmap.github.io" class="logo"><img src="https://handmap.github.io/images/halve.png"></a> <div class="post-title-section"> <div class="section-line">Posts <em>/</em></div> <h1 class="section-title">Exploring OpenCV with Python </h1> <ul class="tags"> <li><a href="https://handmap.github.io/tags#python">python</a></li> <li><a href="https://handmap.github.io/tags#opencv">opencv</a></li> </ul> <div class="section-line reverse"><a href="https://handmap.github.io/posts">Back to posts</a> <em>/</em></div> </div> </div> </div> <div class="block-right"> <div class="share-buttons"> <a href="https://twitter.com/intent/tweet?text=https://handmap.github.io/exploring-opencv-with-python/" class="btn btn_twitter" title="Share on Twitter"><i class="fa fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a> <a href="https://www.facebook.com/sharer/sharer.php?u=https://handmap.github.io/exploring-opencv-with-python/" class="btn btn_facebook" title="Share on Facebook"><i class="fa fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a> <a href="https://plus.google.com/share?url=https://handmap.github.io/exploring-opencv-with-python/" class="btn btn_google-plus" title="Share on Google Plus"><i class="fa fa-fw fa-google-plus" aria-hidden="true"></i><span> Google+</span></a> </div> <a href="../posts.html" title="posts" class="posts-menu-icon"></a> <a title="projects" class="projects-menu-icon"> <span></span> </a> <div class="inner-post content"> <div class="date-highlight">06 Aug 2016</div> <h2 id="introduction">Introduction</h2> <hr /> <p>Today I begin my swim into the murky waters that is <a href="http://opencv.org/">OpenCV</a> (Open Computer Vision). To help accommodate my learning I’ve decided to use the excellent resource by Adrian Rosebrock titled <a href="https://www.pyimagesearch.com/practical-python-opencv/">Practical Python and OpenCV</a>.</p> <p>The main goals of this session are:</p> <ul> <li>Build a better understanding of what the OpenCV libraries are actually capable of rather than continuing to copy code from random examples expecting everything to just work.</li> <li>Build a base class to work with that includes an easy method of drawing video from an interfaced camera onto a display.</li> <li>Perform some kind of analysis on the captured video/images.</li> </ul> <h2 id="python-opencv-requirement-overview">Python OpenCV Requirement overview</h2> <h3 id="opencv">opencv</h3> <hr /> <p>OpenCV itself can be rather painful to install on Linux and OSX. <a href="http://www.pyimagesearch.com/opencv-tutorials-resources-guides/">THIS</a> is a fairly useful resource that should be kept fairly up to date when versions change. OpenCV is written in C/C++ at its core; however there are plenty of other lanaguages that have official binding into the package.</p> <h3 id="numpy">numpy</h3> <hr /> <div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>pip install numpy 
</code></pre></div> <p><a href="http://www.numpy.org/">NumPy</a> is a python library that provides support for large multidimensional arrays. This is important to us because in order to analyse images we need a data structure capable of representing images as data. Take a look at an example of this below that is taken from the <a href="https://www.tensorflow.org/versions/r0.9/tutorials/mnist/beginners/index.html">TensorFlow MNIST For ML Beginners tutorial</a>.</p> <figure> <img src="https://handmap.github.io/images/posts/2016-08-06/MNIST-Matrix.png" alt="TensorFlow MNIST" /> <figcaption>TensorFlow MNIST image to multidimensional array</figcaption> </figure> <p>As you can see the pixels associated with the shape are given weighted values indicating how dark/different they are from the background. This is in a sense how pixels on a display work, except they use RGB (0-&gt;255) colour values and other methods to represent their data.</p> <h3 id="scipy">scipy</h3> <hr /> <div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>pip install scipy 
</code></pre></div> <p><a href="https://www.scipy.org/">SciPy</a> is a package that goes hand-in-hand with NumPy. It provides extended support for highly optimized and efficient scientific computing.</p> <h3 id="matplotlib">matplotlib</h3> <hr /> <div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>pip install matplotlib 
</code></pre></div> <p><a href="http://matplotlib.org/">matplotlib</a> is a plotting library similar to MATLAB. We will be using it extensively to analyse and plot the image data we capture.</p> <h3 id="mahotas">mahotas</h3> <hr /> <div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>pip install mahotas 
</code></pre></div> <p><a href="http://mahotas.readthedocs.io/en/latest/">Mahotas</a> is a computer vision library written explicitely for the python language. Most of its functionality can already be found inside OpenCV however there are some edge cases where Mahotas will need to be used due to limitations on the OpenCV libary.</p> <h3 id="scikit-learn">scikit-learn</h3> <hr /> <div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>pip install scikit-learn 
</code></pre></div> <p><a href="http://scikit-learn.org/">scikit-learn</a> is the machine learning library of choice when we deal with OpenCV. Early on it won’t be used often as our datasets will be quite limited, however overtime we might find a usecase for deep data analysis.</p> <h3 id="scikit-image">scikit-image</h3> <hr /> <div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>pip install -U scikit-image 
</code></pre></div> <p><a href="http://scikit-image.org/">scikit-image</a> provides some fantastic computer vision libraries that are maintained and optimised tremendously well.</p> <h2 id="loading-displaying-and-saving-images">Loading, Displaying and Saving images</h2> <hr /> <p>Lets get started with setting up a simple program to load an image and display it on the screen. To do we’ll first need to import all the libraries we’re going to need. This can be done using the following code:</p> <div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="c"># The top import is for Python2.7 support</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="kn">import</span> <span class="nn">argparse</span>
<span class="kn">import</span> <span class="nn">cv2</span>
</code></pre></div> <p>Next we setup some code to handle the command line arguements to take in the path to an image we wish to load from. We use the <a href="https://docs.python.org/3/library/argparse.html">argparse</a> library for this.</p> <div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="c"># argparse to handle our command line arguments</span>
<span class="n">ap</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
<span class="n">ap</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">"-i"</span><span class="p">,</span> <span class="s">"--image"</span><span class="p">,</span> <span class="n">required</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">help</span> <span class="o">=</span> <span class="s">"Path to the image"</span><span class="p">)</span>

<span class="c"># parse the arguments and store them in a dictionary</span>
<span class="n">args</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">(</span><span class="n">ap</span><span class="o">.</span><span class="n">parse_args</span><span class="p">())</span>
</code></pre></div> <p>Now we can write up some code to read in the image, process it and display it on the screen.</p> <div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="c"># load the image off the disk</span>
<span class="c"># the imread function returns a NumPy array representing the image.</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="s">"image"</span><span class="p">])</span>

<span class="c"># examine the dimensions of the image. The images are represented</span>
<span class="c"># as NumPy arrays, so we can use the shape attribute to examine</span>
<span class="c"># the width, height, and number of channels</span>
<span class="k">print</span><span class="p">(</span><span class="s">"width: {} pixels"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="k">print</span><span class="p">(</span><span class="s">"height: {} pixels"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="k">print</span><span class="p">(</span><span class="s">"channels: {}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>

<span class="c"># handles displaying the actual image on my screen</span>
<span class="c"># the first parameter is a string, the "title" of the window</span>
<span class="c"># the second parameter is a reference to the image we loaded.</span>
<span class="n">cv2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="s">"Image"</span><span class="p">,</span> <span class="n">image</span><span class="p">)</span>

<span class="c"># the cv2.waitKey paused the execution of the script until</span>
<span class="c"># we press a key on the keyboard.</span>
<span class="n">cv2</span><span class="o">.</span><span class="n">waitKey</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c"># lastly we write our image to file in JPG format</span>
<span class="c"># new_image.jpg is just the path to the new file</span>
<span class="n">cv2</span><span class="o">.</span><span class="n">imwrite</span><span class="p">(</span><span class="s">"new_image.jpg"</span><span class="p">,</span> <span class="n">image</span><span class="p">)</span>
</code></pre></div> <p>Now to test it’s as simple as following the command line arguments we setup. I’ve referenced an image ../images/trex.png in this example. This file was located in a folder called ‘images’ one step up in the folder hierarchy.</p> <div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>python load_display_save.py --image ../images/trex.png
</code></pre></div> <p>Running this presents the following information in the console:</p> <div class="language-bash highlighter-rouge"><pre class="highlight"><code>﻿width: 350 pixels
height: 228 pixels
channels: 3
</code></pre></div> <p>This data is the basic information that makes up our image. The height and width are expressed in pixels and you’ll also see 3 channel mentioned which represent the RGB components of the image file.</p> <p>Our image represented as a NumPy array has a shape of (height, width, channels), or (228,350,3).</p> <blockquote> <p>Matrix definitions are typically defines in the form of (# of rows) x (# of columns).</p> </blockquote> <p>We can also observe the image that we loaded has now appeared on the screen</p> <figure> <img src="https://handmap.github.io/images/posts/2016-08-06/OpenCV-image-read-save.png" alt="Trex Output" /> <figcaption>OpenCV load_display_save.py output image</figcaption> </figure> <p>Pressing any key removes the image from the screen and then saves a new copy of the image as ‘new_image.jpg’ in the directory where I ran the script.</p> <h2 id="image-basics">Image Basics</h2> <hr /> <h3 id="pixels">pixels</h3> <hr /> <p>Images consist of a set of pixels. These pixels are the fundamental building blocks of a image. A Pixel can be thought of a the “colour” or the “intensity” of light that appears at any given place in our image.</p> <p>looking back to my trex.png image file, It had a resolution of 350 pixels * 228 pixels. This means that the image has a whopping 79800 pixels all up. Each of these pixels can be represented in two ways:</p> <ol> <li>Grayscale <ul> <li>Each pixel has a value between 0 and 255</li> <li>This value represents each darker colour shift from white through to black.</li> </ul> </li> <li>Colour <ul> <li>Colour is made up of three RGB components (red, green and blue).</li> <li>We store three sets of values between 0 and 255.</li> <li>Each of these values is normally an 8-bit unsigned integer.</li> <li>These three 8bit values are combined into an RGB tuple in the form of (red, green, blue).</li> <li>Example: (255,255,255) is the colour White, while (255,0,0) is the colour red.</li> </ul> </li> </ol> <h3 id="image-coordinates">image coordinates</h3> <hr /> <p>Image coordinates can be best examples by looking at the reference image below taken from the Practical Python and OpenCV tutorial book.</p> <figure> <img src="https://handmap.github.io/images/posts/2016-08-06/Practical-Python-Coordinates.png" alt="Image Coordinates" /> <figcaption>Image coordinate example from PPaOCV book</figcaption> </figure> <p>Above is an 8x8 grid containing 64 individual pixels. You can see how easy it is for us to reference a particular point in an image grid by simply referencing the (row,column) coordinates of the position.</p> <blockquote> <p>Note that Python and many other languages reference arrays of data starting from an index of 0. This means that the first position in the top left of our image is actually (0,0) and not (1,1)</p> </blockquote> <h2 id="accessing-and-manipulating-pixels">Accessing and Manipulating Pixels</h2> <hr /> <p>Next we’re going to try to manipulate our trex image in some way using what we just learnt about pixels and pixel coordinates. To start with I’m going to insert the following base code to setup our import image and display it with the title “Original”</p> <div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="kn">import</span> <span class="nn">argparse</span>
<span class="kn">import</span> <span class="nn">cv2</span>

<span class="n">ap</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
<span class="n">ap</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">"-i"</span><span class="p">,</span> <span class="s">"--image"</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">"Path to the image"</span><span class="p">)</span>
<span class="n">args</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">(</span><span class="n">ap</span><span class="o">.</span><span class="n">parse_args</span><span class="p">())</span>

<span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="s">"image"</span><span class="p">])</span>
<span class="n">cv2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="s">"Original"</span><span class="p">,</span> <span class="n">image</span><span class="p">)</span>
</code></pre></div> <p>Each pixel in the ‘image’ dictionary that we produce with the code above can be referenced by its coordinates and contains a tuple representing its RGB colour.</p> <p>I used the following code to check that the data was in fact in tuple form.</p> <div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="c"># place the prettyprint import at the top of the file</span>
<span class="kn">import</span> <span class="nn">pprint</span>

<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"x value: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span>
              <span class="s">" y value: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span>
              <span class="s">" content: "</span> <span class="o">+</span> <span class="n">pprint</span><span class="o">.</span><span class="n">pformat</span><span class="p">(</span><span class="n">image</span><span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]))</span>
</code></pre></div> <p>This code presents all 79800 pixel entries with their corresponding RGB values. You can see a small example of this below.</p> <div class="language-bash highlighter-rouge"><pre class="highlight"><code>x value: 148 y value: 107 content: array<span class="o">([</span>87, 92, 87], <span class="nv">dtype</span><span class="o">=</span>uint8<span class="o">)</span>
x value: 148 y value: 108 content: array<span class="o">([</span>81, 87, 81], <span class="nv">dtype</span><span class="o">=</span>uint8<span class="o">)</span>
x value: 148 y value: 109 content: array<span class="o">([</span>67, 74, 68], <span class="nv">dtype</span><span class="o">=</span>uint8<span class="o">)</span>
x value: 148 y value: 110 content: array<span class="o">([</span>81, 89, 83], <span class="nv">dtype</span><span class="o">=</span>uint8<span class="o">)</span>
x value: 148 y value: 111 content: array<span class="o">([</span>108, 118, 111], <span class="nv">dtype</span><span class="o">=</span>uint8<span class="o">)</span>
x value: 148 y value: 112 content: array<span class="o">([</span> 92, 101,  93], <span class="nv">dtype</span><span class="o">=</span>uint8<span class="o">)</span>
x value: 148 y value: 113 content: array<span class="o">([</span>76, 86, 77], <span class="nv">dtype</span><span class="o">=</span>uint8<span class="o">)</span>
x value: 148 y value: 114 content: array<span class="o">([</span>100, 110, 101], <span class="nv">dtype</span><span class="o">=</span>uint8<span class="o">)</span>
x value: 148 y value: 115 content: array<span class="o">([</span> 97, 108,  99], <span class="nv">dtype</span><span class="o">=</span>uint8<span class="o">)</span>
x value: 148 y value: 116 content: array<span class="o">([</span>111, 125, 116], <span class="nv">dtype</span><span class="o">=</span>uint8<span class="o">)</span>
x value: 148 y value: 117 content: array<span class="o">([</span>84, 96, 89], <span class="nv">dtype</span><span class="o">=</span>uint8<span class="o">)</span>
x value: 148 y value: 118 content: array<span class="o">([</span>79, 86, 79], <span class="nv">dtype</span><span class="o">=</span>uint8<span class="o">)</span>
x value: 148 y value: 119 content: array<span class="o">([</span>56, 58, 52], <span class="nv">dtype</span><span class="o">=</span>uint8<span class="o">)</span>
</code></pre></div> <p>Something very important to note about the structure of the RGB tuple is that OpenCV stores the RGB channels in reverse order. So the normal [RED, GREEN, BLUE] is actually [BLUE, GREEN, RED]</p> <p>I’ll demonstrate this with the following code that prints each pixel in the image with the colour label.</p> <div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="p">(</span><span class="n">blue</span><span class="p">,</span> <span class="n">green</span><span class="p">,</span> <span class="n">red</span><span class="p">)</span> <span class="o">=</span> <span class="n">image</span><span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Pixel at ("</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="s">","</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="s">") - "</span> <span class="o">+</span>
              <span class="s">"Red: {}, Green: {}, Blue: {}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">red</span><span class="p">,</span> <span class="n">green</span><span class="p">,</span> <span class="n">blue</span><span class="p">))</span>
</code></pre></div> <div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="c"># Output</span>
Pixel at <span class="o">(</span>270,201<span class="o">)</span> - Red: 239, Green: 240, Blue: 244
Pixel at <span class="o">(</span>270,202<span class="o">)</span> - Red: 239, Green: 240, Blue: 244
Pixel at <span class="o">(</span>270,203<span class="o">)</span> - Red: 239, Green: 240, Blue: 244
Pixel at <span class="o">(</span>270,204<span class="o">)</span> - Red: 238, Green: 239, Blue: 243
Pixel at <span class="o">(</span>270,205<span class="o">)</span> - Red: 238, Green: 239, Blue: 243
Pixel at <span class="o">(</span>270,206<span class="o">)</span> - Red: 238, Green: 239, Blue: 243
Pixel at <span class="o">(</span>270,207<span class="o">)</span> - Red: 238, Green: 239, Blue: 243
Pixel at <span class="o">(</span>270,208<span class="o">)</span> - Red: 238, Green: 239, Blue: 243
Pixel at <span class="o">(</span>270,209<span class="o">)</span> - Red: 237, Green: 238, Blue: 242
Pixel at <span class="o">(</span>270,210<span class="o">)</span> - Red: 237, Green: 238, Blue: 242
Pixel at <span class="o">(</span>270,211<span class="o">)</span> - Red: 237, Green: 238, Blue: 243
Pixel at <span class="o">(</span>270,212<span class="o">)</span> - Red: 236, Green: 237, Blue: 242
Pixel at <span class="o">(</span>270,213<span class="o">)</span> - Red: 236, Green: 237, Blue: 242
Pixel at <span class="o">(</span>270,214<span class="o">)</span> - Red: 236, Green: 237, Blue: 242
</code></pre></div> <h3 id="accessing-portions-of-an-image">Accessing portions of an Image</h3> <hr /> <p>You can also access specific parts of an image instead of the whole thing. This kind of technique is important as you don’t want to be having to interate over the same image in its entirity every single time you’re running checks.</p> <p>NumPy provides a technique called array slicing for this very problem. Lets take a look at the following code.</p> <div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="kn">import</span> <span class="nn">argparse</span>
<span class="kn">import</span> <span class="nn">cv2</span>

<span class="n">ap</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
<span class="n">ap</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">"-i"</span><span class="p">,</span> <span class="s">"--image"</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">"Path to the image"</span><span class="p">)</span>
<span class="n">args</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">(</span><span class="n">ap</span><span class="o">.</span><span class="n">parse_args</span><span class="p">())</span>

<span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="s">"image"</span><span class="p">])</span>
<span class="n">cv2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="s">"Original"</span><span class="p">,</span> <span class="n">image</span><span class="p">)</span>

<span class="c"># grab 100 x 100 pixel region of the image</span>
<span class="n">corner</span> <span class="o">=</span> <span class="n">image</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">100</span><span class="p">]</span>
<span class="n">cv2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="s">"Corner"</span><span class="p">,</span> <span class="n">corner</span><span class="p">)</span>

<span class="c"># change the colour of this region to green</span>
<span class="n">image</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">100</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="c"># present the updated image</span>
<span class="n">cv2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="s">"Updated"</span><span class="p">,</span> <span class="n">image</span><span class="p">)</span>
<span class="n">cv2</span><span class="o">.</span><span class="n">waitKey</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div> <p>The four expected indexes that we are expected to provide when slicing are:</p> <ol> <li>Start y <ul> <li>our slice starts at y = 0.</li> </ul> </li> <li>End y <ul> <li>our slice stops alone the y-axis when y = 100.</li> </ul> </li> <li>Start x <ul> <li>our top left x slice starts at x = 0.</li> </ul> </li> <li>End x <ul> <li>our slice stops when the x-axis is x = 100.</li> </ul> </li> </ol> <p>All seemed to go well and I was presented with the output shown below. Note that I generated a number of different window sessions for each step I performed.</p> <figure> <img src="https://handmap.github.io/images/posts/2016-08-06/OpenCV-crop-image.png" alt="Image Crop" /> <figcaption>OpenCV Image crop</figcaption> </figure> <h2 id="conclusion">Conclusion</h2> <hr /> <p>Today was very productive and ended up getting through a good portion of the tutorials. I am not comfortable doing the following:</p> <ul> <li>Installing OpenCV requirements on Ubuntu.</li> <li>Loading and Saving images with OpenCV in python.</li> <li>Manipulating Pixels and image content with Splicing and For Loops.</li> </ul> <p>In my next session I will be working on drawing boxes and lines over the top of images and hopefully also working with live video from my computers webcam.</p> <h3 id="references">References</h3> <hr /> <p>Adrian Rosebrock’s Practical Python on OpenCV - <a href="https://www.pyimagesearch.com/practical-python-opencv/">https://www.pyimagesearch.com/practical-python-opencv/</a></p> <p>TensorFlow MNIST For ML Beginners tutorial - <a href="https://www.tensorflow.org/versions/r0.9/tutorials/mnist/beginners/index.html">https://www.tensorflow.org/versions/r0.9/tutorials/mnist/beginners/index.html</a></p> <p>SciPy - <a href="https://www.scipy.org/">https://www.scipy.org/</a></p> <p>matplotlib - <a href="http://matplotlib.org/">http://matplotlib.org/</a></p> <p>Mahotas - <a href="http://mahotas.readthedocs.io/en/latest/">http://mahotas.readthedocs.io/en/latest/</a></p> <p>scikit-learn - <a href="http://scikit-learn.org/">http://scikit-learn.org/</a></p> <p>scikit-image - <a href="http://scikit-image.org/">http://scikit-image.org/</a></p> <p>argparseg - <a href="https://docs.python.org/3/library/argparse.html">https://docs.python.org/3/library/argparse.html</a></p> <br> <a href="https://twitter.com/intent/tweet?text=https://handmap.github.io/exploring-opencv-with-python/" class="btn btn_twitter" title="Share on Twitter"><i class="fa fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a> <a href="https://www.facebook.com/sharer/sharer.php?u=https://handmap.github.io/exploring-opencv-with-python/" class="btn btn_facebook" title="Share on Facebook"><i class="fa fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a> <a href="https://plus.google.com/share?url=https://handmap.github.io/exploring-opencv-with-python/" class="btn btn_google-plus" title="Share on Google Plus"><i class="fa fa-fw fa-google-plus" aria-hidden="true"></i><span> Google+</span></a> <nav class="pagination"> <a href="https://handmap.github.io/project-introduction/" class="pagination_pager" title="Project Introduction ">previous</a> <a href="https://handmap.github.io/haar-classifier/" class="pagination_pager" title="Haar Classifier Investigation ">next</a> </nav> </div> </div> <!-- JS --> <script src="https://handmap.github.io/assets/js/main.min.js"></script> <div class="overlay"> <ul class="projects-menu"> <li style="background:url(https://github.com/HandMap/HandMap.github.io/blob/master/images/project.jpg) center center no-repeat;"> <a href="https://handmap.github.io" class="inactive" target="_blank" rel="nofollow external"> <span> Hand Map Project <br><em>in progress</em> </span> </a> </li> </ul> </div> </body> </html>
